routeID <- "20190715" # enter routeID for survey
main <- '/Volumes/cindrive/ucrlimeavocado/Data/' # main path to data, all other paths are relative to this one
logFile <- paste(main, 'logs2.xlsx', sep='') # path to log file with metadata
raw_file_path <- paste(main, 'raw/Picarro G2401/', sep = '') # input path to raw Picarro files
v1_file_path <- paste(main, 'processed/Level01/Picarro G2401/', sep='') # output path for Level 1 files
v2_file_path <- paste(main, 'processed/Level02/Picarro G2401/', sep='') # output path for Level 2 files
calSum_file_path <- paste(main, 'processed/calibration_summary/', sep='') # output path for calibration summary files
v3_file_path <- paste(main, 'processed/Level03/Picarro G2401/', sep='') # output path for Level 3 files
qaqc_file_path <- paste(main,'QAQC/Picarro G2401/',sep='') # output path for quality control report
# Libraries ---------------------------------------------------------------
library(data.table)
library(tidyverse)
library(lubridate)
library(stringr)
library(dplyr)
library(readxl)
library(purrr)
source('/Users/cindyyanez/limeavocado/limeavocado_functions.R')
source('/Users/cindyyanez/limeavocado/get_calib_values.R')
source('~/limeavocado/calibrate.R')
surveyInfo = read_excel(logFile, sheet = 'GENERAL') %>% filter(ID == routeID) # import general survey information from log file
files = get_files(surveyInfo, in_path = raw_file_path)  # Finds the data files in your computer using survey info
picarro_v1 = create_level_1(files, v1_file_path) # Level 1 data gets exported
print("Level 1 data has been created and exported")
# Level 2 Processing ------------------------------------------------------------
offset <- read_excel(logFile, sheet = 'TIMEOFFSET') %>% filter(ID == routeID) # import Picarro G2401 time offset
picarro_v2 <- create_level_2(picarro_v1, offset$G2401, v2_file_path) # Level 2 data gets exported
print("Level 2 data has been created and exported")
# Level 3 Processing  ---------------------------------------------
picarro_gps_weather <- merge_picarro_datalogger(picarro_v2, paste(main, surveyInfo$GPSFILE,sep=""), paste(main,surveyInfo$WEATHERFILE,"") %>% # merge Level 2 data with gps and weather
select(-c(CH4, CO2)) %>% rename(CH4 = CH4_dry, CO2 = CO2_dry) # from here on, only use the CO2_dry and CH4_dry columns, they are renamed to CO2 and CH4
# CALIBRATE ---------------------------------------------------------------
calInfo <- read_excel(logFile, sheet = 'CALESTIMATES') %>% filter(ID == routeID) # load the calibration information
# CALIBRATE ---------------------------------------------------------------
calInfo <- 5
